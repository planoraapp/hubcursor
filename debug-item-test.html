<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Itens na Mão</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .item-btn { padding: 10px; margin: 5px; cursor: pointer; }
        .selected { background: #2196f3; color: white; }
        .avatar-preview { max-width: 300px; border: 2px solid #333; }
        .debug-info { background: #f0f0f0; padding: 10px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>🔍 Debug - Itens na Mão</h1>
    
    <div class="test-section">
        <h3>🎭 Ação</h3>
        <button class="item-btn" data-action="">Nada</button>
        <button class="item-btn" data-action="crr">Carregando</button>
        <button class="item-btn" data-action="drk">Bebendo</button>
    </div>
    
    <div class="test-section">
        <h3>🤲 Item</h3>
        <button class="item-btn" data-item="=0">Nada</button>
        <button class="item-btn" data-item="=1">Água</button>
        <button class="item-btn" data-item="=2">Cenoura</button>
        <button class="item-btn" data-item="=3">Sorvete</button>
        <button class="item-btn" data-item="=5">Habbo Cola</button>
    </div>
    
    <div class="test-section">
        <h3>🎭 Avatar Preview</h3>
        <img id="avatarPreview" class="avatar-preview" src="https://www.habbo.com/habbo-imaging/avatarimage?figure=hd-190-7-.hr-100-7-.ch-210-66-.lg-270-82-.sh-290-80-&gender=M&direction=2&head_direction=2&action=&gesture=nrm&size=l" alt="Avatar">
    </div>
    
    <div class="test-section">
        <h3>🔗 URL Atual</h3>
        <div id="currentUrl" class="debug-info">URL será exibida aqui...</div>
    </div>
    
    <div class="test-section">
        <h3>📊 Estado Atual</h3>
        <div id="debugInfo" class="debug-info">Aguardando...</div>
    </div>
    
    <script>
        class ItemDebugger {
            constructor() {
                this.currentState = {
                    action: '',
                    item: '=0'
                };
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.updateAvatar();
                this.updateDebugInfo();
            }
            
            setupEventListeners() {
                // Ações
                document.querySelectorAll('[data-action]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('[data-action]').forEach(b => b.classList.remove('selected'));
                        btn.classList.add('selected');
                        
                        this.currentState.action = btn.dataset.action;
                        console.log(`🎭 Ação selecionada: ${this.currentState.action || 'Nenhuma'}`);
                        this.updateAvatar();
                    });
                });
                
                // Itens
                document.querySelectorAll('[data-item]').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('[data-item]').forEach(b => b.classList.remove('selected'));
                        btn.classList.add('selected');
                        
                        this.currentState.item = btn.dataset.item;
                        console.log(`🤲 Item selecionado: ${this.currentState.item}`);
                        this.updateAvatar();
                    });
                });
                
                // Selecionar "Nada" por padrão
                document.querySelector('[data-action=""]').classList.add('selected');
                document.querySelector('[data-item="=0"]').classList.add('selected');
            }
            
            updateAvatar() {
                // Construir parâmetro de ação como no HabboTemplarios
                let actionParam = '';
                if (this.currentState.action && this.currentState.item && this.currentState.item !== '=0') {
                    // Se há ação e item, usar formato: action=,crr=ID
                    const itemId = this.currentState.item.replace('=', '');
                    actionParam = `,${this.currentState.action}=${itemId}`;
                    console.log(`🔗 Construindo: action=,${this.currentState.action}=${itemId}`);
                } else if (this.currentState.action) {
                    // Se só há ação, usar: action=wlk
                    actionParam = this.currentState.action;
                    console.log(`🔗 Construindo: action=${this.currentState.action}`);
                } else {
                    console.log(`🔗 Construindo: action= (vazio)`);
                }
                
                const avatarUrl = `https://www.habbo.com/habbo-imaging/avatarimage?figure=hd-190-7-.hr-100-7-.ch-210-66-.lg-270-82-.sh-290-80-&gender=M&direction=2&head_direction=2&action=${actionParam}&gesture=nrm&size=l`;
                
                document.getElementById('avatarPreview').src = avatarUrl;
                document.getElementById('currentUrl').textContent = avatarUrl;
                
                console.log(`🔗 URL Final: ${avatarUrl}`);
                console.log(`🎭 Ação: ${actionParam || 'Nenhuma'}`);
                console.log(`🤲 Item: ${this.currentState.item}`);
                
                this.updateDebugInfo();
            }
            
            updateDebugInfo() {
                const info = `
Estado Atual:
- Ação: ${this.currentState.action || 'Nenhuma'}
- Item: ${this.currentState.item}
- Parâmetro de Ação: ${this.currentState.action && this.currentState.item !== '=0' ? `,${this.currentState.action}=${this.currentState.item.replace('=', '')}` : this.currentState.action || 'Nenhum'}
                `;
                
                document.getElementById('debugInfo').textContent = info;
            }
        }
        
        // Inicializar quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            window.itemDebugger = new ItemDebugger();
        });
    </script>
</body>
</html>
