<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔍 Investigador HabboTemplarios - HabboHub</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        .investigator-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .section {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2196F3;
        }
        .results {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="investigator-container">
        <h1>🔍 Investigador HabboTemplarios</h1>
        <p>Este investigador analisa o site do HabboTemplarios para extrair as categorias e roupas reais.</p>
        
        <div class="section">
            <h3>📋 Métodos de Investigação</h3>
            <p>Escolha como quer investigar o site:</p>
            
            <button onclick="openHabboTemplarios()">🌐 Abrir HabboTemplarios</button>
            <button onclick="analyzeIframe()">🔍 Analisar Iframe (se disponível)</button>
            <button onclick="simulateUserNavigation()">👤 Simular Navegação do Usuário</button>
            <button onclick="extractFromConsole()">📱 Extrair do Console F12</button>
            <button onclick="analyzeNetworkRequests()">🌐 Analisar Requisições de Rede</button>
        </div>
        
        <div class="section">
            <h3>🎯 Resultados da Investigação</h3>
            <div id="investigationResults" class="results">
                Clique em um método para começar a investigação...
            </div>
        </div>
        
        <div class="section">
            <h3>📊 Dados Extraídos</h3>
            <div id="extractedData" class="results">
                Nenhum dado extraído ainda...
            </div>
        </div>
        
        <div class="section">
            <h3>🌐 Preview do Site (Iframe)</h3>
            <div id="iframeContainer">
                <p>Clique em "Abrir HabboTemplarios" para carregar o iframe...</p>
            </div>
        </div>
    </div>

    <script>
        let investigationData = {};
        
        // Função para abrir o HabboTemplarios em iframe
        function openHabboTemplarios() {
            console.log('🌐 === ABRINDO HABBOTEMPLARIOS ===');
            
            const container = document.getElementById('iframeContainer');
            container.innerHTML = `
                <iframe 
                    src="https://habbotemplarios.com/generador-de-habbos" 
                    id="habboTemplariosFrame"
                    onload="onIframeLoaded()"
                ></iframe>
            `;
            
            updateResults('✅ Iframe do HabboTemplarios carregado! Aguarde o carregamento completo...');
        }
        
        // Quando o iframe carregar
        function onIframeLoaded() {
            console.log('🎯 Iframe carregado!');
            updateResults('🎯 Iframe carregado com sucesso! Agora podemos analisar o conteúdo.');
            
            // Aguardar um pouco para o conteúdo carregar
            setTimeout(() => {
                analyzeIframe();
            }, 3000);
        }
        
        // Analisar o conteúdo do iframe
        function analyzeIframe() {
            console.log('🔍 === ANALISANDO IFRAME ===');
            
            try {
                const iframe = document.getElementById('habboTemplariosFrame');
                if (!iframe || !iframe.contentDocument) {
                    updateResults('❌ Não foi possível acessar o conteúdo do iframe (CORS)');
                    return;
                }
                
                const doc = iframe.contentDocument;
                console.log('📄 Documento do iframe:', doc);
                
                // Procurar por elementos de roupas
                const clothingElements = doc.querySelectorAll('[class*="clothing"], [class*="item"], [class*="grid"]');
                console.log('👕 Elementos de roupas encontrados:', clothingElements.length);
                
                // Procurar por categorias
                const categoryElements = doc.querySelectorAll('[class*="category"], [class*="tab"], [class*="section"]');
                console.log('📂 Elementos de categoria encontrados:', categoryElements.length);
                
                // Procurar por scripts que carregam dados
                const scripts = doc.querySelectorAll('script');
                console.log('📜 Scripts encontrados:', scripts.length);
                
                updateResults(`🔍 Análise do iframe concluída:
                - Elementos de roupas: ${clothingElements.length}
                - Elementos de categoria: ${categoryElements.length}
                - Scripts: ${scripts.length}
                
                Verifique o console para mais detalhes.`);
                
            } catch (error) {
                console.error('❌ Erro ao analisar iframe:', error);
                updateResults(`❌ Erro ao analisar iframe: ${error.message}`);
            }
        }
        
        // Simular navegação do usuário
        function simulateUserNavigation() {
            console.log('👤 === SIMULANDO NAVEGAÇÃO DO USUÁRIO ===');
            
            updateResults('👤 Simulando navegação do usuário...');
            
            // Lista de URLs para investigar
            const urlsToInvestigate = [
                'https://habbotemplarios.com/generador-de-habbos',
                'https://habbotemplarios.com/api/clothes',
                'https://habbotemplarios.com/api/categories',
                'https://habbotemplarios.com/js/clothes.js',
                'https://habbotemplarios.com/js/categories.js'
            ];
            
            // Tentar acessar cada URL
            urlsToInvestigate.forEach((url, index) => {
                setTimeout(() => {
                    investigateURL(url);
                }, index * 1000);
            });
        }
        
        // Investigar uma URL específica
        async function investigateURL(url) {
            try {
                console.log(`🔍 Investigando: ${url}`);
                
                const response = await fetch(url);
                const contentType = response.headers.get('content-type');
                
                if (contentType && contentType.includes('application/json')) {
                    const data = await response.json();
                    console.log(`✅ JSON encontrado em ${url}:`, data);
                    updateResults(`✅ JSON encontrado em ${url}: ${JSON.stringify(data).substring(0, 200)}...`);
                    
                    // Salvar dados extraídos
                    investigationData[url] = data;
                    updateExtractedData();
                    
                } else if (contentType && contentType.includes('text/html')) {
                    const html = await response.text();
                    console.log(`✅ HTML encontrado em ${url}:`, html.substring(0, 500));
                    updateResults(`✅ HTML encontrado em ${url} (${html.length} caracteres)`);
                    
                    // Procurar por dados de roupas no HTML
                    extractClothingDataFromHTML(html, url);
                    
                } else {
                    console.log(`ℹ️ Conteúdo não reconhecido em ${url}: ${contentType}`);
                    updateResults(`ℹ️ Conteúdo não reconhecido em ${url}: ${contentType}`);
                }
                
            } catch (error) {
                console.log(`❌ Erro ao investigar ${url}:`, error.message);
                updateResults(`❌ Erro ao investigar ${url}: ${error.message}`);
            }
        }
        
        // Extrair dados de roupas do HTML
        function extractClothingDataFromHTML(html, url) {
            console.log('🔍 === EXTRAINDO DADOS DE ROUPAS DO HTML ===');
            
            // Procurar por padrões comuns de dados de roupas
            const patterns = [
                /clothingData\s*=\s*(\{.*?\});/gs,
                /clothes\s*=\s*(\[.*?\]);/gs,
                /categories\s*=\s*(\[.*?\]);/gs,
                /items\s*=\s*(\[.*?\]);/gs,
                /data-clothing="([^"]+)"/g,
                /data-category="([^"]+)"/g
            ];
            
            patterns.forEach((pattern, index) => {
                const matches = html.match(pattern);
                if (matches) {
                    console.log(`🎯 Padrão ${index + 1} encontrado:`, matches);
                    updateResults(`🎯 Padrão ${index + 1} encontrado em ${url}: ${matches.length} matches`);
                    
                    // Tentar fazer parse dos dados
                    matches.forEach((match, matchIndex) => {
                        if (matchIndex > 0 && match) { // Ignorar o match completo
                            try {
                                const parsed = JSON.parse(match);
                                console.log(`✅ Dados parseados do padrão ${index + 1}:`, parsed);
                                investigationData[`pattern_${index}_${matchIndex}`] = parsed;
                                updateExtractedData();
                            } catch (e) {
                                console.log(`⚠️ Não foi possível fazer parse: ${match.substring(0, 100)}...`);
                            }
                        }
                    });
                }
            });
        }
        
        // Extrair dados do console F12
        function extractFromConsole() {
            console.log('📱 === EXTRAINDO DO CONSOLE F12 ===');
            
            updateResults('📱 Para extrair dados do console F12:
            
            1. Abra o site do HabboTemplarios
            2. Pressione F12 para abrir as ferramentas do desenvolvedor
            3. Vá para a aba Console
            4. Procure por mensagens relacionadas a roupas, categorias ou dados
            5. Copie e cole aqui os dados encontrados
            
            Dica: Procure por variáveis como:
            - clothingData
            - clothes
            - categories
            - items
            - console.log de roupas');
            
            // Criar área para colar dados
            const container = document.getElementById('extractedData');
            container.innerHTML = `
                <h4>📋 Cole aqui os dados do console:</h4>
                <textarea 
                    id="consoleDataInput" 
                    placeholder="Cole aqui os dados encontrados no console F12..."
                    style="width: 100%; height: 200px; font-family: monospace;"
                ></textarea>
                <br><br>
                <button onclick="parseConsoleData()">🔍 Analisar Dados Colados</button>
            `;
        }
        
        // Analisar dados colados do console
        function parseConsoleData() {
            const input = document.getElementById('consoleDataInput');
            const data = input.value.trim();
            
            if (!data) {
                updateResults('❌ Nenhum dado foi colado!');
                return;
            }
            
            console.log('🔍 === ANALISANDO DADOS COLADOS ===');
            console.log('Dados colados:', data);
            
            try {
                // Tentar fazer parse como JSON
                const parsed = JSON.parse(data);
                console.log('✅ Dados parseados com sucesso:', parsed);
                
                investigationData['console_data'] = parsed;
                updateExtractedData();
                updateResults('✅ Dados do console parseados e salvos!');
                
            } catch (error) {
                console.log('⚠️ Não é JSON válido, tentando extrair padrões...');
                
                // Tentar extrair padrões do texto
                extractClothingDataFromHTML(data, 'console_data');
                updateResults('⚠️ Dados não são JSON válido, mas padrões foram extraídos.');
            }
        }
        
        // Analisar requisições de rede
        function analyzeNetworkRequests() {
            console.log('🌐 === ANALISANDO REQUISIÇÕES DE REDE ===');
            
            updateResults('🌐 Para analisar requisições de rede:
            
            1. Abra o site do HabboTemplarios
            2. Pressione F12 para abrir as ferramentas do desenvolvedor
            3. Vá para a aba Network
            4. Recarregue a página
            5. Procure por requisições que retornem dados de roupas
            6. Verifique as respostas das requisições
            
            Dica: Procure por:
            - Requisições para /api/
            - Requisições para arquivos .js
            - Requisições que retornem JSON
            - Requisições com nomes relacionados a roupas');
        }
        
        // Funções auxiliares
        function updateResults(message) {
            const results = document.getElementById('investigationResults');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `<br>[${timestamp}] ${message}`;
            results.scrollTop = results.scrollHeight;
        }
        
        function updateExtractedData() {
            const container = document.getElementById('extractedData');
            container.innerHTML = `
                <h4>📊 Dados Extraídos (${Object.keys(investigationData).length} fontes):</h4>
                <pre>${JSON.stringify(investigationData, null, 2)}</pre>
            `;
        }
        
        // Inicialização
        console.log('🔍 Investigador HabboTemplarios inicializado!');
        updateResults('🚀 Sistema de investigação inicializado!');
    </script>
</body>
</html>
