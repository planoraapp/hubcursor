<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Imagens de Handitems</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .handitem { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 8px; display: flex; align-items: center; gap: 15px; }
        .handitem img { width: 40px; height: 40px; border: 1px solid #ccc; }
        .handitem .info { flex: 1; }
        .handitem .status { padding: 5px 10px; border-radius: 4px; font-weight: bold; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .loading { background: #fff3cd; color: #856404; }
        button { padding: 10px 20px; margin: 10px 5px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .test-item { border: 1px solid #ddd; padding: 10px; border-radius: 5px; text-align: center; }
        .test-item img { width: 60px; height: 60px; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Teste de Imagens de Handitems</h1>
        <p>Este script testa a disponibilidade e exibi√ß√£o das imagens de handitems.</p>
        
        <div>
            <button onclick="testHanditemImages()" id="testBtn">Testar Imagens</button>
            <button onclick="testSpecificHanditems()" id="specificBtn">Testar Handitems Espec√≠ficos</button>
            <button onclick="clearResults()">Limpar Resultados</button>
        </div>
        
        <div id="status"></div>
        <div id="results"></div>
        <div id="specificResults" class="grid"></div>
    </div>

    <script>
        async function testHanditemImages() {
            const btn = document.getElementById('testBtn');
            const status = document.getElementById('status');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = 'Testando...';
            status.innerHTML = '<div class="loading">üîç Testando imagens de handitems...</div>';
            results.innerHTML = '';
            
            const testHanditems = [
                { id: 1, name: "Ch√°" },
                { id: 2, name: "Suco" },
                { id: 3, name: "Cenoura" },
                { id: 4, name: "Sorvete de Baunilha" },
                { id: 5, name: "Leite" },
                { id: 25, name: "Po√ß√£o do Amor" },
                { id: 30, name: "L√≠quido Radioativo" },
                { id: 176, name: "Handitem 176" },
                { id: 177, name: "Handitem 177" }
            ];
            
            const results_data = [];
            
            for (const item of testHanditems) {
                const result = await testHanditemImage(item.id, item.name);
                results_data.push(result);
            }
            
            // Exibir resultados
            results.innerHTML = results_data.map(item => `
                <div class="handitem">
                    <img src="${item.imageUrl}" alt="${item.name}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjZjBmMGYwIi8+Cjx0ZXh0IHg9IjIwIiB5PSIyMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjOTk5IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkeT0iLjNlbSI+PDw8L3RleHQ+Cjwvc3ZnPg=='">
                    <div class="info">
                        <h3>${item.name} (ID: ${item.id})</h3>
                        <p>URL: ${item.imageUrl}</p>
                        <p>Status: <span class="status ${item.status === 'success' ? 'success' : 'error'}">${item.status === 'success' ? '‚úÖ Dispon√≠vel' : '‚ùå N√£o encontrado'}</span></p>
                    </div>
                </div>
            `).join('');
            
            const successCount = results_data.filter(item => item.status === 'success').length;
            status.innerHTML = `<div class="success">‚úÖ Teste conclu√≠do! ${successCount}/${results_data.length} imagens dispon√≠veis</div>`;
            
            btn.disabled = false;
            btn.textContent = 'Testar Imagens';
        }
        
        async function testSpecificHanditems() {
            const btn = document.getElementById('specificBtn');
            const status = document.getElementById('status');
            const results = document.getElementById('specificResults');
            
            btn.disabled = true;
            btn.textContent = 'Testando...';
            status.innerHTML = '<div class="loading">üîç Testando handitems espec√≠ficos (176-180)...</div>';
            results.innerHTML = '';
            
            const currentYear = new Date().getFullYear();
            const currentMonth = String(new Date().getMonth() + 1).padStart(2, '0');
            const baseUrl = `https://images.habbotemplarios.com/${currentYear}/${currentMonth}/handitem`;
            
            for (let id = 176; id <= 180; id++) {
                const variations = [0, 1, 2, 3];
                const availableVariations = [];
                
                for (const variation of variations) {
                    const url = `${baseUrl}${id}_${variation}.png`;
                    const exists = await imageExists(url);
                    if (exists) {
                        availableVariations.push({ variation, url });
                    }
                }
                
                if (availableVariations.length > 0) {
                    results.innerHTML += `
                        <div class="test-item">
                            <h3>Handitem ${id}</h3>
                            <p>Varia√ß√µes: ${availableVariations.length}/4</p>
                            <div>
                                ${availableVariations.map(v => `
                                    <img src="${v.url}" alt="Varia√ß√£o ${v.variation}" title="Varia√ß√£o ${v.variation}" style="width: 30px; height: 30px; margin: 2px;">
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            status.innerHTML = '<div class="success">‚úÖ Teste de handitems espec√≠ficos conclu√≠do!</div>';
            btn.disabled = false;
            btn.textContent = 'Testar Handitems Espec√≠ficos';
        }
        
        async function testHanditemImage(id, name) {
            // Testar diferentes padr√µes de URL
            const patterns = [
                `https://images.habbotemplarios.com/web/avatargen/hand_${name.toLowerCase().replace(/\s+/g, '')}.png`,
                `https://images.habbotemplarios.com/web/avatargen/hand_${name.toLowerCase().replace(/\s+/g, '_')}.png`,
                `https://images.habbotemplarios.com/web/avatargen/handitem_${id}.png`,
                `https://images.habbotemplarios.com/2025/09/handitem${id}_0.png`
            ];
            
            for (const url of patterns) {
                if (await imageExists(url)) {
                    return { id, name, imageUrl: url, status: 'success' };
                }
            }
            
            return { id, name, imageUrl: patterns[0], status: 'error' };
        }
        
        async function imageExists(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                return response.ok;
            } catch {
                return false;
            }
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('specificResults').innerHTML = '';
            document.getElementById('status').innerHTML = '';
        }
    </script>
</body>
</html>
